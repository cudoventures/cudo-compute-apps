_format_version: '3.0'
_transform: true

services:
  - name: triton-http
    url: http://triton:8000
    routes:
      - name: http
        paths:
          - /triton-http
    plugins:
      - name: key-auth
  - name: triton-grpc
    protocol: grpc
    host: triton
    port: 8001
    routes:
      - name: grpc
        protocols:
          - grpc
        paths:
          - /triton-grpc
#    plugins:
#      - name: key-auth
  - name: triton-metrics
    url: http://triton:8002
    routes:
      - name: metrics
        paths:
          - /triton-metrics
    plugins:
      - name: key-auth

consumers:
  - username: kong-user
    keyauth_credentials:
      - key: KEY_AUTH_KEY